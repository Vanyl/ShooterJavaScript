<html>

<head>
    <script src="/ShooterJavaScript/PhaserLib/phaser.min.js"></script>
    <title> </title>
</head>

<body>
    <script type="text/javascript">
        var config = {
            type: Phaser.AUTO,
            width: 360,
            height: 640,
            physics: {
                default: 'arcade'
            },
            scene: {
                preload: preload,
                create: create,
                //update: update
            }
        };

        var game = new Phaser.Game(config);

        var sprite1, sprite2;
        var testObject, answer_1, answer_2, question;
        var choice1, choice2;
        var currentid;





        function preload() {
            this.load.image('question', './Assets/bulleconvers.png');
            this.load.image('reponse', './Assets/bulleconvers2.png');
            this.load.image('choice', './Assets/bulleconvers3.png');

            this.load.text('SequenceQR', 'SequenceQR.json')

        }

        function create() {

            this.cameras.main.setBackgroundColor(0xbababa);

            //Rajout des bulles conversations (variable sprite)
            this.add.sprite(175, 50, 'question');            
            sprite1 = this.add.sprite(90, 610, 'choice').setInteractive();
            sprite2 = this.add.sprite(270, 610, 'choice').setInteractive();

            //Rajout fichier JSON
            testObject = JSON.parse(this.cache.text.get("SequenceQR"));
            currentid = 0;

            //Lien bulle/texte (variable texte)
            question = this.add.text(10, 43, testObject.Sequence[currentid].question);
            choice1 = this.add.text(5, 605, testObject.Sequence[currentid].answer1);
            choice2 = this.add.text(195, 605, testObject.Sequence[currentid].answer2);
            
            this.input.on('gameobjectover', function (pointer, sprite1) { sprite1.setTint(0x7d7d7d); });
            this.input.on('gameobjectout', function (pointer, sprite1) { sprite1.clearTint(); });

            //Event clic
            sprite1.on('pointerdown', addResponse1, this);
            sprite2.on('pointerdown', addResponse2, this);
        }


        function addResponse1() {
            var answer_sprite = this.add.sprite(180, 115, 'reponse');
            answer_1 = this.add.text(15, 110, testObject.Sequence[currentid].answer1);
            
            currentid = testObject.Sequence[currentid].ifquestion1;
            question.text = testObject.Sequence[currentid].question;
            choice1.text = testObject.Sequence[currentid].answer1;
            choice2.text = testObject.Sequence[currentid].answer2;
        }

        function addResponse2() {
            var answer_sprite = this.add.sprite(180, 115, 'reponse');
            answer_2 = this.add.text(15, 110, testObject.Sequence[currentid].answer2);
            
            currentid = testObject.Sequence[currentid].ifquestion2;
            question.text = testObject.Sequence[currentid].question;
            choice2.text = testObject.Sequence[currentid].answer2;
            choice1.text = testObject.Sequence[currentid].answer1;
        }

    </script>

</body>

</html>
